{% extends 'layout.twig' %}

{% block Main %}
    <pre>{{ dump(data) }}</pre>
    <div class="main__calendar">
        <div class="main__calendar__inner">
            <div class="calendar">
                <div class="calendar__head">
                    <div class="calendar__arrow calendar__arrow_left js-calendar-prev"></div>
                    <div class="calendar__date js-calendar-toggle">28 дек &#183; Сегодня</div>
                    <div class="calendar__arrow calendar__arrow_right js-calendar-next"></div>
                </div>
                <div class="calendar__dropdown js-calendar-container"></div>
            </div>
        </div>
    </div>
    <div class="main__schedule js-schedule">
        <div class="main__schedule__inner">
            <div class="main__schedule__col-left js-col-left">
                {% for key, floor in data %}
                    <div class="main__floor" data-id="{{ key }}">
                        <div class="main__floor__title">{{ key }} этаж</div>
                        {% for room in floor %}
                            <div class="main__schedule__room" data-id="{{ room.id }}">
                                <div class="main__schedule__room__name">{{ room.title }}</div>
                                <div class="main__schedule__room__capacity">
                                    {% if room.capacityMin == 0 %}
                                        до {{ room.capacityMax }} человек
                                    {% else %}
                                        {{ room.capacityMin }}—{{ room.capacityMax }} человек
                                    {% endif %}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% endfor %}
            </div>
            <div class="main__schedule__col-right">
                <div class="main__schedule__col-right__inner">
                    <div class="main__hours">
                        {% for i in 8..23 %}
                            {% if loop.index == 1 %}
                                <div class="main__hours__item js-hours-item" data-time="{{ i }}:00">{{ i }}:00</div>
                            {% else %}
                                <div class="main__hours__item js-hours-item" data-time="{{ i }}:00">{{ i }}</div>
                            {% endif %}
                        {% endfor %}
                    </div>
                    <div class="main__lines">
                        <span class="main__lines__current" style="left: 9.375%">
                            <span class="main__lines__current__label">{{ "now"|date("H:i") }}</span>
                        </span>
                        {% for i in 8..23 %}
                            <span class="main__lines__item"></span>
                        {% endfor %}
                    </div>
                    <div class="main__events">
                    {% for key, floor in data %}
                        <div class="main__events__floor">
                        <div class="main__events__row main__events__row_empty">
                            <div class="main__events__floor__title js-events-floor">{{ key }} этаж</div>
                        </div>
                        {% for room in floor %}
                            <div class="main__events__row">
                                <span class="main__events__room busy js-events-room">{{ room.title }}</span>
                                {% if room.Events | length > 0 %}
                                    {% for event in room.Events %}

                                    {% if event.type and event.type == 'empty' %}
                                        <div class="main__events__item js-event-item"
                                            data-timeStart="{{ event.dateStart | date("H:i") }}"
                                            data-timeEnd="{{ event.dateEnd | date("H:i") }}"
                                            style="width: 5.25%;"></div>
                                    {% else %}                       
                                        <div class="main__events__item js-event-item busy"
                                            data-timeStart="{{ event.dateStart | date("H:i") }}"
                                            data-timeEnd="{{ event.dateEnd | date("H:i") }}"
                                            style="width: 5.25%;"></div>
                                    {% endif %}
                                    {% endfor %}
                                {% else %}
                                    <div class="main__events__item js-event-item" style="width: 100%;"><a href="/newevent.html" class="main__events__item__add">+</a></div>
                                {% endif %}
                            </div>
                        {% endfor %}
                        </div>
                    {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="js-event"></div>
{% endblock %}

{% block pageScript %}
    <script type="text/javascript" src="/build/scripts/index/index.js"></script>
{% endblock %}